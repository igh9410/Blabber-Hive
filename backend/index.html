<!DOCTYPE html>
<html>
  <head>
    <title>WebSocket Test</title>
  </head>
  <body>
    <h1>WebSocket Chat</h1>

    <textarea id="chatLog" cols="50" rows="20"></textarea><br />
    <input id="message" type="text" />
    <button onclick="sendMessage()">Send</button>

    <script>
      // Replace 'your_chat_id_here' with the actual chat ID
      var chatId = "e11b45da-9206-4642-a2bd-57d17ca074dc";
      let token =
        "eyJhbGciOiJIUzI1NiIsImtpZCI6ImxPNWR2bDd2NWdMM0dxTzIiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNjk1NTU4NTQyLCJpYXQiOjE2OTQ5NTM3NDIsImlzcyI6Imh0dHBzOi8vaHRnd2praGtoa3JxZmFqZG5lb3Muc3VwYWJhc2UuY28vYXV0aC92MSIsInN1YiI6ImFlZDVmNDEyLWUzMDctNGNjMS1hNjUyLTdjMDE5ODkyZWNmMSIsImVtYWlsIjoiaWdoOTQxMEBuYXZlci5jb20iLCJwaG9uZSI6IiIsImFwcF9tZXRhZGF0YSI6eyJwcm92aWRlciI6ImVtYWlsIiwicHJvdmlkZXJzIjpbImVtYWlsIl19LCJ1c2VyX21ldGFkYXRhIjp7fSwicm9sZSI6ImF1dGhlbnRpY2F0ZWQiLCJhYWwiOiJhYWwxIiwiYW1yIjpbeyJtZXRob2QiOiJwYXNzd29yZCIsInRpbWVzdGFtcCI6MTY5NDUwNTQ0NX1dLCJzZXNzaW9uX2lkIjoiMDdkZDM0NjAtN2MyOC00MmQ4LWIwNzQtNDMyOWIzZmVjMzI1In0.wWKp8ME9lAg9eyRASQexm7EHbM0hqhDQV6DrmQaxA9s";

      var ws = new WebSocket(
        `ws://localhost:8080/ws/chats/${chatId}?token=${token}`
      );

      ws.onopen = function (event) {
        console.log("WebSocket is open now.");
      };

      ws.onmessage = function (event) {
        console.log("Received a message from the server:", event.data);
        var chatLog = document.getElementById("chatLog");
        chatLog.value += event.data + "\n";
      };

      // Listen for possible errors
      ws.addEventListener("error", (event) => {
        console.log("WebSocket error: ", event);
      });

      ws.onclose = function (event) {
        console.log("WebSocket is closed now.", event);
      };

      function sendMessage() {
        var message = document.getElementById("message").value;
        console.log("Sending message:", message);
        ws.send(message);
      }
    </script>
  </body>
</html>
