<!DOCTYPE html>
<html lang="en">
  <head>
    <title>WebSocket Test</title>
  </head>
  <body>
    <h1>WebSocket Chat</h1>

    <textarea id="chatLog" cols="50" rows="20"></textarea><br />
    <input id="message" type="text" />
    <button onclick="sendMessage()">Send</button>

    <script>
      // Replace 'your_chat_id_here' with the actual chat ID
      var chatId = "c976b969-a8b1-4503-8026-0825467b0fee";

      let token =
        "eyJhbGciOiJIUzI1NiIsImtpZCI6ImxPNWR2bDd2NWdMM0dxTzIiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNjk2MTM0MzE1LCJpYXQiOjE2OTU1Mjk1MTUsImlzcyI6Imh0dHBzOi8vaHRnd2praGtoa3JxZmFqZG5lb3Muc3VwYWJhc2UuY28vYXV0aC92MSIsInN1YiI6ImNiZjJmMjg3LTdhZmEtNGI5NS1hMWUxLWM4YTdjYzUzYjE3MiIsImVtYWlsIjoiYXRoYW5hc2lhOTQxMEBnbWFpbC5jb20iLCJwaG9uZSI6IiIsImFwcF9tZXRhZGF0YSI6eyJwcm92aWRlciI6ImVtYWlsIiwicHJvdmlkZXJzIjpbImVtYWlsIiwiZ29vZ2xlIl19LCJ1c2VyX21ldGFkYXRhIjp7ImF2YXRhcl91cmwiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NKNWg2eF9XWkFPQVlNMl9lcmZCZmhFQmNQdDZ4ejZqbHRDcWRLUFhoRlNxWGM9czk2LWMiLCJlbWFpbCI6ImF0aGFuYXNpYTk0MTBAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImZ1bGxfbmFtZSI6Ikdlb25oeXVrIEltIChBTkdBTkdBTkdBTkcpIiwiaXNzIjoiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tIiwibmFtZSI6Ikdlb25oeXVrIEltIChBTkdBTkdBTkdBTkcpIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FDZzhvY0o1aDZ4X1daQU9BWU0yX2VyZkJmaEVCY1B0Nnh6NmpsdENxZEtQWGhGU3FYYz1zOTYtYyIsInByb3ZpZGVyX2lkIjoiMTE2NTc0MjI0NjUzNjU2NzczMDAwIiwic3ViIjoiMTE2NTc0MjI0NjUzNjU2NzczMDAwIn0sInJvbGUiOiJhdXRoZW50aWNhdGVkIiwiYWFsIjoiYWFsMSIsImFtciI6W3sibWV0aG9kIjoib2F1dGgiLCJ0aW1lc3RhbXAiOjE2OTU1Mjk1MTV9XSwic2Vzc2lvbl9pZCI6IjZmYjBiODUxLTU1NTQtNDQ3NS1iMDYxLTZmOGJmNzQ2OWU4YSJ9.WqrjvNYylkcZuNMIbmI_S1HbBwZVNNNjXi9h6dXD-bE";
      var ws = new WebSocket(
        `ws://localhost:8080/ws/chats/${chatId}?token=${token}`
      );

      ws.onopen = function (event) {
        console.log("WebSocket is open now.");
      };

      ws.onmessage = function (event) {
        console.log("Received a message from the server:", event.data);
        var chatLog = document.getElementById("chatLog");
        chatLog.value += event.data + "\n";
      };

      // Listen for possible errors
      ws.addEventListener("error", (event) => {
        console.log("WebSocket error: ", event);
      });

      ws.onclose = function (event) {
        console.log("WebSocket is closed now.", event);
      };

      function sendMessage() {
        var message = document.getElementById("message").value;
        console.log("Sending message:", message);
        ws.send(message);
      }
    </script>
  </body>
</html>
